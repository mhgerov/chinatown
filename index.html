<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chinatown Board</title>
  <style>
    body {
      background-color: #a57548;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    .board {
      display: grid;
      grid-template-columns: repeat(3, auto);
      grid-template-rows: repeat(2, auto);
      gap: 40px;
      margin-bottom: 40px;
    }

    .block {
      display: grid;
      gap: 2px;
    }

    .plot {
      width: 60px;
      height: 60px;
      border: 1px solid #000;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 32px;
      text-align: center;
      font-weight: bold;
      flex-direction: column;
    }

    .plot:empty {
      border: none;
      background: transparent;
    }

    .red {
      background-color: red;
      color: white;
    }

    .blue {
      background-color: blue;
      color: white;
    }

    .green {
      background-color: green;
      color: white;
    }

    .yellow {
      background-color: gold;
      color: black;
    }

    .purple {
      background-color: purple;
      color: white;
    }

    table {
      border-collapse: collapse;
      background-color: #ddd;
    }

    th,
    td {
      border: 1px solid #aaa;
      padding: 8px;
      text-align: center;
    }

    .player-cell {
      font-weight: bold;
      color: white;
    }

    .player-red {
      background-color: red;
    }

    .player-blue {
      background-color: blue;
    }

    .player-green {
      background-color: green;
    }

    .player-yellow {
      background-color: gold;
      color: black;
    }

    .player-purple {
      background-color: purple;
    }

    .balance-cell,
    .business-cell {
      background-color: ivory;
    }

    .round-table th,
    .round-table td:first-child {
      background-color: #ddd;
    }

    .round-table td:not(:first-child) {
      background-color: ivory;
    }

    .deck-grid {
      display: grid;
      grid-template-columns: repeat(3, auto);
      gap: 8px 16px;
    }

    .active-round {
      background-color: black !important;
      color: white !important;
    }

    .reference-section {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 20px;
      align-items: flex-start;
    }

    .turn-phases {
      list-style: decimal;
      padding-left: 20px;
      margin: 0;
    }

    .tooltip {
      position: absolute;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: normal;
      pointer-events: none;
      z-index: 1000;
      white-space: nowrap;
    }
  </style>
</head>

<body>
  <h2>The Board</h2>
  <div class="board"></div>
  <h2>Game State</h2>
  <div style="display: flex; justify-content: center; gap: 40px; align-items: flex-start; margin-top: 20px;">
    <table>
      <thead>
        <tr>
          <th>Player</th>
          <th>Businesses</th>
        </tr>
      </thead>
      <tbody id="player-stats"></tbody>
    </table>

    <div id="business-deck" style="background: #eee; padding: 10px; border-radius: 10px; min-width: 120px;">
      <h3 style="margin-top: 0;">Business Tile Deck</h3>
      <div class="deck-grid" id="business-deck-grid"></div>
    </div>
  </div>

  <script>

    // static data
    const layout = [
      [null, 1, 2, null, null, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, null, 13, 14, 15, null],
      [16, 17, 18, 19, 20, 21, 22, 23, null, 24, 25, null, 26, 27, null],
      [28, 29, 30, null, 31, 32, 33, null, 34, 35, 36, null, null, 37, 38, 39, null, 40, 41, 42],
      [43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, null, null, 55, 56, null, null, 57, 58],
      [59, 60, null, 61, 62, null, 63, 64, 65, 66, 67, 68, null, 69, 70],
      [71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, null],
    ];

    const businesses = {
      photo: 'ðŸ“·3', 
      tea: 'â˜•3', 
      seafood: 'ðŸ¦€3', 
      jewellery: 'ðŸ’Ž4',
      fish: 'ðŸŸ4',
      flowers: 'ðŸŒ¸4',
      takeout: 'ðŸ¥¡5',
      laundry: 'ðŸ§º5',
      dimsum: 'ðŸ¥Ÿ5',
      antiques: 'ðŸº6',
      factory: 'ðŸ­6',
      restaurant: 'ðŸ½ï¸6',
    };

    // before game start
    const players = {
      red: 'Josh',
      green: 'Erin',
      blue: 'Christian',
      yellow: 'Damon',
      purple: 'Denise'
    }

    // game state
    const ownedPlots = {
      red: [],
      green: [72,73,75,76,77,78,80,81,82,83,85],
      blue: [1,17,18,19,20,26,27,32,34,36,37,38,39,40,41,42,49,60,62,61,63,64,65,66,67,68,69,70,79],
      yellow: [2,3,5,6,7,8,9,10,11,12,15,28,29,30,31],
      purple: [22,24,44,45,46,48,50,51,52,54]
    };;

    const businessInventory = {
      red: [],
      green: ['jewellery','jewellery','laundry','dimsum'], 
      blue: ['jewellery','fish','fish','laundry','antiques','restaurant'],
      yellow: ['factory'], 
      purple: ['antiques','antiques']
    };

    const businessAssignments = {
      2: 'factory',
      3: 'factory',
      5: 'factory',
      6: 'factory',
      7: 'factory',
      8: 'restaurant',
      9: 'restaurant',
      10: 'restaurant',
      11: 'restaurant',
      12: 'restaurant',
      15: 'restaurant',
      17: 'antiques',
      18: 'antiques',
      19: 'antiques',
      20: 'antiques',
      24: 'flowers',
      26: 'dimsum',
      27: 'dimsum',
      28: 'jewellery',
      29: 'jewellery',
      30: 'jewellery',
      31: 'jewellery',
      32: 'laundry',
      34: 'laundry',
      36: 'laundry',
      37: 'laundry',
      38: 'dimsum',
      39: 'dimsum',
      40: 'dimsum',
      41: 'dimsum',
      42: 'dimsum',
      44: 'photo',
      45: 'photo',
      46: 'flowers',
      48: 'photo',
      49: 'seafood',
      50: 'flowers',
      51: 'photo',
      52: 'photo',
      54: 'flowers',
      60: 'flowers',
      61: 'flowers',
      62: 'flowers',
      63: 'seafood',
      64: 'seafood',
      65: 'seafood',
      66: 'fish',
      67: 'fish',
      68: 'fish',
      69: 'fish',
      70: 'fish',
      72: 'tea',
      73: 'takeout',
      77: 'takeout',
      78: 'takeout',
      75: 'tea',
      76: 'tea',
      80: 'takeout',
      81: 'takeout',
      82: 'takeout',
      83: 'tea',
      85: 'takeout'
    };

    const businessDeck = {
      photo: 1,
      tea: 2,
      seafood: 2,
      jewellery: 0,
      fish: 0,
      flowers: 0,
      takeout: 1,
      laundry: 2,
      dimsum: 0,
      antiques: 2,
      factory: 3,
      restaurant: 2
    }

    // page generation code
    const board = document.querySelector('.board');

    layout.forEach((block, index) => {
      const b = document.createElement('div');
      b.className = 'block';
      const isBuilding2or5 = index === 1 || index === 4;
      const columns = isBuilding2or5 ? 3 : 4;
      const rows = Math.ceil(block.length / columns);
      b.style.gridTemplateColumns = `repeat(${columns}, 60px)`;
      b.style.gridTemplateRows = `repeat(${rows}, 60px)`;

      block.forEach(n => {
        const div = document.createElement('div');
        div.className = 'plot';
        if (n !== null) {
          let plotOwner = null;
          for (const [color, plots] of Object.entries(ownedPlots)) {
            if (plots.includes(n)) {
              plotOwner = color;
              break;
            }
          }
          if (plotOwner) {
            div.classList.add(plotOwner);
          } else {
            div.style.backgroundColor = 'gainsboro';
          }
          if (businessAssignments[n]) {
            const businessKey = businessAssignments[n];
            const entry = businesses[businessKey] || '';
            const emoji = entry.slice(0, -1);
            const size = entry.slice(-1);
            div.innerHTML = `<div>${emoji}</div><div style="font-size:14px; line-height:1;">${size}</div>`;
            
            // Add hover functionality to show property number
            div.style.position = 'relative';
            div.addEventListener('mouseenter', function(e) {
              const tooltip = document.createElement('div');
              tooltip.className = 'tooltip';
              tooltip.textContent = `Property ${n}`;
              document.body.appendChild(tooltip);
              
              const rect = div.getBoundingClientRect();
              tooltip.style.left = (rect.left + rect.width / 2 - tooltip.offsetWidth / 2) + 'px';
              tooltip.style.top = (rect.top - tooltip.offsetHeight - 5) + 'px';
            });
            
            div.addEventListener('mouseleave', function(e) {
              const tooltip = document.querySelector('.tooltip');
              if (tooltip) {
                tooltip.remove();
              }
            });
          } else {
            div.textContent = n;
          }
        }
        b.appendChild(div);
      });
      board.appendChild(b);
    });

    const playerStats = document.getElementById('player-stats');
    Object.entries(players).forEach(([color]) => {
      const tr = document.createElement('tr');
      const tdName = document.createElement('td');
      tdName.className = `player-cell player-${color}`;
      tdName.textContent = players[color];
      const tdBiz = document.createElement('td');
      tdBiz.className = 'business-cell';
      const businessList = (businessInventory[color] || []).map(key => businesses[key]).join(', ');
      tdBiz.textContent = businessList;
      tr.appendChild(tdName);
      tr.appendChild(tdBiz);
      playerStats.appendChild(tr);
    });

    const businessDeckGrid = document.getElementById('business-deck-grid');
    Object.entries(businessDeck).forEach(([key, count]) => {
      const entry = businesses[key] || '';
      const line = document.createElement('div');
      line.style.fontSize = '20px';
      line.textContent = `[${entry}] x${count}`;
      businessDeckGrid.appendChild(line);
    });
  </script>
  <table class="round-table" style="margin-top: 40px;">
    <thead>
      <tr>
        <th>Current Round</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th class="active-round">6</th>
      </tr>
    </thead>
    <tbody>
      <tr><td><strong>Plots</strong></td><td>5/3</td><td>5/3</td><td>5/3</td><td>4/2</td><td>4/2</td><td>4/2</td></tr>
      <tr><td><strong>Business Tiles</strong></td><td>5</td><td>3</td><td>3</td><td>2</td><td>2</td><td>2</td></tr>
    </tbody>
  </table>
  <h2>Reference</h2>
  <div class="reference-section">
    <div>
      <h3>Income</h3>
      <table>
      <thead>
        <tr>
          <th></th>
          <th>1</th>
          <th>2</th>
          <th>3</th>
          <th>4</th>
          <th>5</th>
          <th>6</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Incomplete</td>
          <td>$10k</td>
          <td>$20k</td>
          <td>$40k</td>
          <td>$60k</td>
          <td>$80k</td>
          <td>-</td>
        </tr>
        <tr>
          <td>Complete</td>
          <td>-</td>
          <td>-</td>
          <td>$50k</td>
          <td>$80k</td>
          <td>$110k</td>
          <td>$140k</td>
        </tr>
      </tbody>
    </table>
    </div>

    <div style="align-self: flex-start;">
      <h3>Phases in a Round</h3>
      <ol class="turn-phases">
        <li>Deal & Discard Building Plots</li>
        <li>Deal Business Tiles</li>
        <li>Trades & Negotiations</li>
        <li>Place Business Tiles</li>
        <li>Earn Income</li>
      </ol>
    </div>
  </div>

  <div style="text-align: center; margin-top: 40px;">
    <h3>Business Tiles</h3>
    <img src="img/shop-tiles.png" alt="Business Tile Reference" style="max-width: 100%; height: auto;">
  </div>

</body>

</html>